SELECT  AD_COR, AD_CODCOR,
(SELECT CODPROD  FROM TGFPRO P WHERE PRO.AD_COR = P.AD_COR AND
-- TROCAR O AD_CODMODELO NA LINHA ABAIXO
 P.AD_CODMODELO LIKE 'GAB. VIDRO CURVA DUPLA%' AND P.AD_BASE_MERCOS IS NULL AND P.AD_INTEGRA_MERCOS IS  NULL) AS CODPRODMP
, 1 AS QTDMISTURA
, PRO.CODPROD AS CODPRODPA, 0 AS CODLOCALBAIXA, 0 AS CODLOCALORIG
,'MT' AS CODVOL, 'N' AS CONSUREFUGO, NULL AS  CONTROLEMP, ' ' AS CONTROLEPA, 'N' AS ESTOQUETERCEIRO
,'N' AS FIXAQTDAPO,'S' AS GERAREQUISICAO
, (SELECT IDEFX FROM TPREFX WHERE IDPROC = PA.IDPROC AND DESCRICAO LIKE 'ACABAMENTO FINAL' ) AS IDEFX
, 'N' LIBERADESVIO, NULL AS PERCDESVIOINF
,NULL AS PERCDESVIOSUP
,  (SELECT  NVL(MAX(SEQMP),0)  FROM TPRLMP M WHERE  IDEFX IN (SELECT IDEFX FROM TPREFX WHERE IDPROC = PA.IDPROC AND DESCRICAO LIKE 'ACABAMENTO FINAL'  ) )+ ROWNUM AS SEQMP
, 'L' AS TIPOCONTROLEMP, 'V' AS TIPOQTD, 'N' AS TIPOUSOMP, 'S' AS VERIFICAEST, NULL AS VINCULOSERIEPA 
FROM TGFPRO PRO INNER JOIN TPRLPA PA ON PRO.CODPROD = PA.CODPRODPA AND  PA.IDPROC IN (35)
WHERE 
-- TROCAR O CÃ“DIGO DO PRODUTO NA LINHA ABAIXO
PRO.AD_CODMODELO IN ( 'CDS40CO IQ'
)
AND  (SELECT IDEFX FROM TPREFX WHERE IDPROC = PA.IDPROC AND DESCRICAO LIKE  'ACABAMENTO FINAL'  )  = 829
AND NOT EXISTS (SELECT * FROM TPRLMP MP WHERE MP.CODPRODPA = PRO.CODPROD AND IDEFX = 829 AND MP.CODPRODMP IN (SELECT CODPROD  FROM TGFPRO P WHERE 
-- TROCAR O AD_CODMODELO DA LINHA ABAIXO 
 P.AD_CODMODELO LIKE 'GAB. VIDRO CURVA DUPLA%' AND P.AD_BASE_MERCOS IS NULL AND P.AD_INTEGRA_MERCOS IS  NULL))   ;
 